SELECT CLI.ID_CLIENTE, cli.nome, SUM(I.QUANTIDADE * I.PRECO_UNITARIO) compras
FROM CLIENTE CLI
RIGHT OUTER JOIN VENDA V ON CLI.ID_CLIENTE = V.ID_CLIENTE
RIGHT OUTER JOIN ITENS_VENDA I ON V.ID_VENDA = I.ID_VENDA
group by cli.id_cliente, cli.nome
order by SUM(I.QUANTIDADE * I.PRECO_UNITARIO) desc